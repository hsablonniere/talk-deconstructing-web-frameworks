= the  Web,  its  Frameworks  and its  Standards : deconstructing them for a more resilient code base...
Hubert SablonniÃ¨re
:author-twitter: @hsablonniere
:author-avatar: img/hsablonniere-profil-2017.jpg
:author-company: Clever Cloud
:author-company-logo: img/clever-cloud-logo.svg
:event: Voxxed CERN
:date: may 1st, 2019

[slide=poster]
Poster

[.time]#00:00:00#

[.stop-music.dark, slide=blank]
Fading to black


[.old.play-music]
== Prologue...

#Wait for music#
#Deep and sad voice#
Wandering in the jungle of the modern Web,

image::img/drawings-optimized/thinking.svg[]

our main character is lost.
Since he started his career, weeks after weeks, years after years,

image::img/drawings-optimized/thinking-words.svg[]

he saw the birth of many revolutionary and promising tools,
but tomorrow, maybe, those could all vanish and be replaced by new ones ... *even more better*.
It is with lots of sadness and a bit of melancholia that he remembers all these frameworks, librairies, code editors and other command line tools.

image::img/drawings-optimized/rip.svg[]

#Whisper#
Please show some respect!
If they haven't already disappeared from our projects,
maybe they already have disappeared from our...

image::img/drawings-optimized/radar.svg[]

coolness radards.
This situation worries him and keeps him up at nights.
In his current job, he has to make technical choices, yet he doesn't know what to do anymore.
It is at this very moment that our main character decided to see...

[.reset-music]
image::img/drawings-optimized/dr-sigma.svg[]

...a therapist.
[.four]#Restart la musique (Gymnopedie)#

image::img/drawings-optimized/talking-legos.svg[]

#Tired and sad voice#
ğŸ˜ Hello doctor.
#Confident voice#
ğŸ‘©â€âš•ï¸ Hello Mr SablonniÃ¨re? So? What can I do for you?
Last time I saw you, it was like 10 years ago...
You just started your first job and you had some kind of PTSD about wether to use "spaces or tabs" and on the pronunciation of "animated guiffs".
#Like a millenial#
ğŸ˜ You mean djifs, right?

.2 spaces,   it's better!
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-thinks.svg[]

#Brag about being a senior dev#
ğŸ˜ Yeah but that's all in the past now, I was young, I wasn't asking myself the right questions.
I recently took a few steps back about the frontend Web and I made an observation:

.Too much hype,   we've become addicts!
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-talks.svg[]

ğŸ˜ There's way too much hype around tools and we've all become addicted to them.
ğŸ‘©â€âš•ï¸ Humm, tell me more, what kind of problems does it imply?

image::img/drawings-optimized/projecteur.svg[]

#Energy voice#
ğŸ˜ So, problem number 1...
#Surprised voice#
ğŸ‘©â€âš•ï¸ Hummm... when someone asks you a question, do you always answer with a PowerPoint?

.I AM NOT   using PowerPoint!
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-thinks.svg[]

#Really happy#
ğŸ˜ Oh yeah! It's very handy, you know.
#Steps down#
Anyway.

.Problem #1
[slide=problem]
Finding solutions   to problems we don't have (yet)

ğŸ˜ ProblÃ¨me numÃ©ro 1...
When we choose a framework, a frontend library and its ecosystem, we often forget the original problem we wanted to solve.
*And yet*, we feel like we already found *the right answer*, *the right solution* to use.
Most of the time, it's the right tool for the right job but sometimes, the solution was designed to solve problems we don't really have.

.Why?
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-talks.svg[]

ğŸ‘©â€âš•ï¸ Why on earth would you do that?

image::img/drawings-optimized/dx-ux.svg[]

ğŸ˜ Well, sometimes it's because it's **cool**!
But it forces us to put the developer experience before the user experience,
the user of the very product we're trying to build.

image::img/drawings-optimized/giant.svg[]

ğŸ˜ Sometime it's because it's used or even created by a Web giant, one of the big 5. Oh yeah!
// Ã‡a forme un cycle:
// * les gÃ©ants l'utilisent
// * on l'utilise
// * les recruteurs nous attirent avec
// * les dÃ©butants se forment dessus
// * on crÃ©Ã© des confs dÃ©diÃ©es
// * on crÃ©Ã© des meetups

.Go on, go on... !
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-talks.svg[]

ğŸ‘©â€âš•ï¸ Go on, go on...

.Problem #2
[slide=problem]
Getting locked into our own ecosystem

ğŸ˜ Problem number 2...
Once we chose an ecosystem, we tend to get locked into it.
// https://en.wikipedia.org/wiki/Escalation_of_commitment
// https://fr.wikipedia.org/wiki/Escalade_d%27engagement
// https://en.wikipedia.org/wiki/Sunk_cost
// https://fr.wikipedia.org/wiki/Co%C3%BBt_irr%C3%A9cup%C3%A9rable

image::img/drawings-optimized/silos.svg[]

ğŸ˜ We open a specific door and we stay cosy inside without looking outside, at what others do.
This means we're going to look for "how to do X or Y" with *THIS* ecosytem even if X or Y a pretty much universal frontend problems.
A bit like when we wanted to maniulate arrays or dates with jQuery.
We're going to rewrite yet another "select" or "datagrid" component dedicated to this ecosystem.
We'll prefix all our stackoverflow questions with "angular", "react" or "vue".
And like all fanboys/fangirls,
we don't always see the limitations of what we love,
and we convince ourselves that we need those shiny new features without understanding them very well.

image::img/drawings-optimized/brain.svg[]

ğŸ˜ We're going to fill our brains with...

image::img/drawings-optimized/brain-fwk.svg[]

ğŸ˜ ...features and concepts specific to our own ecosystem...
// ğŸ˜ Difficile de changer de cap quand on a investi du temps d'apprentissage.

image::img/drawings-optimized/brain-patterns.svg[]

ğŸ˜ ...instead of filling them with well known standards and patterns.

.Oh, so just like   Apple keynotes?
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-thinks.svg[]

ğŸ‘©â€âš•ï¸ Hum, hum, I see...
// Ah vous entendre, on dirait mon fils devant une confÃ©rence Apple, quand ils sortent l'iPod ou l'iPhone, je comprends qu'il soit Ã©merveillÃ©
// Mais quand Apple dit "on a virÃ© le jack" il dit, "ah mais ces vraiment des gÃ©nies" alors qu'il a pas de casque bluetooth
// Rant sur les exemples de code dÃ©corÃ©s apple

.Problem #3
[slide=problem]
...

ğŸ˜ Problem number 3...
This one is pretty universal,
We easily forget the basics, the patterns and best practices like SOLID or "separation of concerns".

.Problem #3
[slide=problem]
Writing strongly coupled code   that does not age well with time

We tend to write code that is strongly coupled and that does not age well with time.

image::img/drawings-optimized/layers.svg[]

ğŸ˜ Instead of having well defined and isolated layers...

image::img/drawings-optimized/layers-mixed.svg[]

ğŸ˜ ...we write modules that mix several responsibilities and we couple our code to the implementation of global stuffs in the project.
In the end,
* when our own ecosystem evolves,
* when it disappears,
* or when a new standard rises,
it becomes very hard to replace pieces one at a time.

image::img/drawings-optimized/trash.svg[]

ğŸ˜ We're going to throw away...

image::img/drawings-optimized/trash-brain.svg[]

ğŸ˜ ...parts of our knowledge...

image::img/drawings-optimized/trash-project.svg[]

ğŸ˜ ...and lots of code.

.#FeatureLessRefactoring
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-talks.svg[]

Hashtag "I love feature less refactors"

.WTF?
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-talks.svg[]


ğŸ‘©â€âš•ï¸ OK, I'm completely lost.
ğŸ˜ Ah...
Humm, it's a but like my TV.

.Just like my TV!
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-talks.svg[]

ğŸ˜ Last time I went to see you 10 years ago,
I just started my first job but I also just bought a new TV with my internship money.

image::img/drawings-optimized/tv.svg[]

ğŸ˜ I still have this TV,
and it works *just* like it did 10 years ago.
Its still working and relevant because it only does one thing and it does it well.
It doesn't know what I'm going to plug into it, it just enforces an interface : HDMI.

image::img/drawings-optimized/tv-pc.svg[]

ğŸ˜ At first, I plugged a huge desktop computer with some movies,

image::img/drawings-optimized/tv-raspberry.svg[]

ğŸ˜ then I went for a smaller one.
I plugged many different devices that didn't exist back then,
but it worked.

image::img/drawings-optimized/tv-androidtv.svg[]

ğŸ˜ I even discovered by accident that on top of receiving audio/video via HDMI,
it could send signals (via HDMI-CEC) to source devices.
Anyway, today, when I look at frontend projects...

image::img/drawings-optimized/tv-vcr.svg[]

ğŸ˜ I see *this!*
ğŸ‘©â€âš•ï¸ Oh yeah, TV+VCR combos!
I had one of those! It was really handy, you didn't have to worry about configuration and wires, it was almost magical.
But when our VCR broke, we had to throw both away and buy something new.

// image::img/drawings-optimized/tv-vcr-real.svg[]

.Ah, you see?
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-talks.svg[]

ğŸ˜ Oh, so you see what I mean?
ğŸ˜ You see why I'm lost?

.OK, OK, I see...
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-talks.svg[]

ğŸ‘©â€âš•ï¸ OK, OK, I see...
The best solution in your case...

.Group therapy!
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-talks.svg[]

ğŸ‘©â€âš•ï¸ ...is group therapy with profesionnals from your industry !
so I gathered a small group of people here.

.I'll go   but I'm scared!
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-thinks.svg[]

ğŸ˜ Well... it's not what I call a small group...

.Everything's    gonna be alright!
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-talks.svg[]

ğŸ‘©â€âš•ï¸ Don't worry, everything's gonna be alright!

[.stop-music, slide=poster]
Hello

[.time]#00:06:00#
Hello everyone!
I'm Hubert SablonniÃ¨re,
I'm a Web Developer at #Clever Cloud#,
and today, I want to talk about:
* the Web,
* its frameworks and librairies
* and its standards.
A very simple topic without any polemics or drama.
We're gonna try to deconstruct all this
in the hope of building better web apps tomorrow.

[slide=blank]
Transition

OK, alors on utilise tous pleins d'outils super cools qui nous apportent des solutions...

== What was the  *problem* anyway?

[.time]#00:06:30#
...mais c'Ã©tait quoi le problÃ¨me Ã  la base ?
...
Sur cette partie, j'ai essayÃ© de lister les principaux problÃ¨mes auquels j'ai fait face dans mes diffÃ©rentes expÃ©riences de dev sur le Web.

[slide=needs, display=0]
_

D'un cÃ´tÃ©, on a les problÃ¨mes qu'on veux rÃ©soudre pour les utilisatrices et utilisateurs du produit qu'on dÃ©veloppe,
et de l'autre, on a les problÃ¨mes qu'on rencontre *NOUS* les devs.
...
Alors, en tant que user, on veut :

[slide=needs, display=1]
_

Un 1er chargement rapide.

[slide=needs, display=2]
_

Une fois la page chargÃ©e,
on veut que les navigations consÃ©cutives soient rapides aussi.
//C'est le critÃ¨re qui a motivÃ© le fait de faire du rendu cÃ´tÃ© client.

[slide=needs, display=3]
_

On veut que ce soit fluide et rÃ©actif,

[slide=needs, display=4]
_

que la consommation batterie, CPU, RAM reste raisonnable,

[slide=needs, display=5]
_

que Ã§a soit accessible Ã  tous,

[slide=needs, display=6]
_

et que Ã§a marche partout.
...
DÃ©jÃ  lÃ , on voit qu'le contexte joue Ã  mort.
C'est en fonction de *"ce que vous codez"* que l'importance de ces problÃ¨mes varie.
Si vous codez une app oÃ¹ l'utilisatrice est active (genre gMail ou Slack), la rapiditÃ© du 1er chargement c'est pas trop votre problÃ¨me principal.
MÃªme chose de l'autre cÃ´tÃ© du spectre, si vous codez une site oÃ¹ l'utilisateur fait bcp de lecture et de navigation,
la fluiditÃ© avec des animations Ã  60 fps, bah forcÃ©ment, c'est pas un problÃ¨me que vous avez.
...
Ne notre cÃ´tÃ©, en tant que dev, on veut :

[slide=needs, display=7]
_

Gagner du temps, ne pas rÃ©inventer la roue,

[slide=needs, display=8]
_

Ã©crire du code propre, rÃ©utilisable,

[slide=needs, display=9]
_

avec des abstraction pour garder un modÃ¨le de pensÃ©e simple.

[slide=needs, display=10]
_

On veut une isolation des impacts de nos changements,

[slide=needs, display=11]
_

Ã©viter de faire certaines erreurs et autres bugs...
et petit bonus,

[slide=needs, display=12]
_

si on peut facilement collaborer avec des non-dev, c'est cool.
...
Ici, c'est en fonction de *"avec qui vous codez"*, votre Ã©quipe et son expÃ©rience, que l'importance des problÃ¨mes varie.

[slide=blank]
Transition

OK, donc lÃ , si vous Ãªtes plutÃ´t backend et que vous n'avez pas suivi le monde du front/Web ces derniÃ¨res annÃ©es,
vous vous dites :
"Non mais attend Hubert, lÃ  tu viens de lister Ã  peu prÃ¨s les mÃªmes problÃ¨mes qu'on essayait de rÃ©gler il y a 10 ans."
"J'ai vraiment l'impression que vous vous Ãªtes complexifiÃ© la vie avec tous vos outils compliquÃ© alors que le problÃ¨me est simple."
...
OK, mettons de cÃ´tÃ© l'ironie de cette remarque et posons nous la question :

== *How* did we  get here?


[.time]#00:08:00#
Comment est-ce qu'on en est arrivÃ© lÃ  ?
Est-ce qu'on a vraiment besoin de tous ces outils ?

[quote]
In order to understand where we're going,   we need to know where we come from.

Pour comprendre oÃ¹ on va, il faut savoir d'oÃ¹ on vient.
#blasÃ©#
Je sais pas trop qui a dit Ã§a, dÃ©so.
Mais il a bien raison !

image::img/drawings/browser-1.jpg[]

Ã€ la base on avait un Web assez simple mais puissant dans ses concepts.
Un utilisateur demande une URL Ã  son navigateur,
le navigateur fait une requÃªte HTTP vers un serveur,
le serveur applique un template et rÃ©pond un document HTML,
merci au revoir.

image::img/drawings/browser-2.jpg[]

Ensuite, on a rajoutÃ© des images, des CSS et surtout des formulaires.
L'utilisateur pouvait interragir avec le document une fois qu'il Ã©tait chargÃ©.
// click
// POST
// nouvelle page HTML

image::img/drawings/browser-3.jpg[]

Ã‡a a commencÃ© Ã  se complexifier assez tÃ´t avec l'arrivÃ©e de JavaScript.
On avait maintenant la possibilitÃ© en tant que dev de rÃ©pondre directement Ã  des inputs de l'utilisateurs.
Sans faire d'aller/retour rÃ©seau.
Au dÃ©part, on faisait de la manipulation de DOM.

image::img/drawings/browser-4.jpg[]

Ensuite avec la vague AJAX, jQuery et compagnie,
on a commencÃ© Ã  faire faire de plus en plus de chose Ã  cette partie JavaScript
et du coup Ã  charger de plus de plus de code.

image::img/drawings/browser-5.jpg[]

On est passÃ© d'appels AJAX pour rÃ©cupÃ©rer des bouts de templates HTML
Ã  faire ne rÃ©cupÃ©rer que du JSON pour faire du templating cÃ´tÃ© client
et surtout du routing cÃ´tÃ© client
on gagnait bcp en perf sur les navigations consÃ©cutives

image::img/drawings/browser-6.jpg[]

par contre, le jusqueboutisme de cette logique nous a amenÃ© Ã  une Ã¨re qui nous est encore familÃ¨re,
l'Ã¨re du <body> vide avec le mega fat bundle javascript qui contient tout.
et lÃ  le premier chargement, il est pas trop content

image::img/drawings/browser-7.jpg[]

C'est un peu pour revenir au meilleur des 2 mondes
qu'on essaye aujourd'hui d'avoir un premier chargement avec rendu cÃ´tÃ© serveur qui ne contient que ce qui est nÃ©cessaire
et de charger le reste au fur et Ã  mesure.

image::img/drawings/browser-8.jpg[]

N'oublions pas que tout Ã§a s'est fait pendant la pÃ©riode de
l'arrivÃ©e des mobiles, du stockage local et des workers

image::img/drawings/browser-9.jpg[]

image::img/drawings/browser-10.jpg[]

image::img/drawings/browser-11.jpg[]

[slide=blank]
Transition

== What do *frameworks*  bring to the table?


[.time]#00:10:00#

[slide=text]
*Frameworks* vs. *libs* ?

framework => cadre de travail
opinionated set of libs/tools
problem is when this set of libs/tools is only compatible with itself
de mon expÃ©rience, les projets frameworks X ou Y ne se ressemble pas quand le contexte est diffÃ©rent
...
historique
jquery
Frameworks are also their to prevent browser quirks

[slide=todo-schema]
image::img/drawings-optimized/silos-colors.svg[]

Angular and ember are opinionated
React is supposed to be unopinionated
Vue is a bit in the middle
special mention to ember

[slide=todo-schema]
image::img/drawings-optimized/silos-rooms.svg[]

[slide=blank]
on efface

image::img/drawings/bookshelf-empty.jpg[]

// mentionner les Ã©tapes qui nÃ©cessitent un outil de build
// est-ce que la source de l'outil de build est spÃ©cifique ou est-elle un peu standard ?
// mentionner des dÃ©tails sur les implÃ©mentations

// points importants Ã  aborder

[slide=needs, focus=""]
Component system (API + runtime)

[slide=needs, focus="7,9"]
Component system (API + runtime)

image::img/drawings/bookshelf-1.jpg[]

Angular et Vue "data down, events up"
=> methods
React "data down, action up" (ou callback called)
=> props pour les children
Tous: attrs et lifecycle methods
Slots ?

[slide=needs, focus=""]
"Templating" / ViewModel

[slide=needs, focus="0,6,7,8,9,10,11"]
"Templating" / ViewModel

image::img/drawings/bookshelf-2.jpg[]

=> JSX, templates
=> 1 file vs several files
=> output pur JS, vs JS + CSS
Mvc, mvvm, template + vue model, computed properties
exemple Angular, React, Vue

[slide=needs, focus=""]
CSS authoring

[slide=needs, focus="0,9"]
CSS authoring

image::img/drawings/bookshelf-3.jpg[]

=> BEM, CSS-in-JS lib, encapsulation system

[slide=needs, focus=""]
DOM manipulation

[slide=needs, focus="2,3,4,5,8"]
DOM manipulation

image::img/drawings/bookshelf-4.jpg[]

=> Direct binding vs Virtual DOM (+ scheduling microtask...)
The Virtual DOM was always a big marketing argument to sell React but why would we care.
It's an implementation detail an clearly, if they changed their impl and are still fast, we should not care at all.

[slide=needs, focus=""]
SSR (Server Side Rendering)

[slide=needs, focus="0,5"]
SSR (Server Side Rendering)

image::img/drawings/bookshelf-5.jpg[]

[slide=needs, focus=""]
Router

[slide=needs, focus="1"]
Router

image::img/drawings/bookshelf-6.jpg[]

[slide=needs, focus=""]
State manager

[slide=needs, focus="7,8"]
State manager

image::img/drawings/bookshelf-7.jpg[]

image::img/drawings/bookshelf-8.jpg[]

en vrac car moins important pour notre discussion
CLI
Devtools
HTTP client
Form handling
Module system
Dep inj
i18n
tests

[slide=blank]
Transition

en terme de conception de d'organisation des composants (et de sÃ©paration des concerns etc)
les 3 communautÃ©s ont des choses intÃ©ressantes Ã  dire

== What do *standards*  bring to the table?


[.time]#00:20:00#

image::img/screenshots/site-jquery.jpg[url=https://jquery.com/]

prÃ©ambule exemple jquery => sizzle + ajax + API chainÃ©e sucre syntaxique

// [slide=todo]
// schÃ©ma cycle

.Web Components
[slide=web-components]
_

image::img/drawings-optimized/web-component-tv.svg[]
// UTILISER LE SCHEMA DE LA TV
schÃ©ma de la tÃ©lÃ© => analogie avec le Web component

image::img/drawings-optimized/web-component.svg[]

.Custom Elements
[slide=web-components]
_
// custom element => modÃ¨le de composant avec lifecycle methods et "data binding" sur les attributs

.Custom Element
[source, language=javascript, subs="none"]
--
class EnvVarInput extends HTMLElement {
    /* ... */
}

customElements.define('env-var-input', EnvVarInput);

<env-var-input name="FOO" value="BAR"></env-var-input>
--

image::img/drawings-optimized/web-component-attr.svg[]

image::img/drawings-optimized/web-component-prop.svg[]

image::img/drawings-optimized/web-component-methods.svg[]

image::img/drawings-optimized/web-component-events.svg[]

.Custom Element
[source, language=javascript, subs="none"]
--
class EnvVarInput extends HTMLElement {
    connectedCallback() {
        /* ... */
    }
    disconnectedCallback() {
        /* ... */
    }
    adoptedCallback() {
        /* ... */
    }
}
--

.Custom Element
[source, language=javascript, subs="none"]
--
class EnvVarInput extends HTMLElement {
    static get observedAttributes() {
        return ['name', 'value'];
    }
    attributeChangedCallback() {
        /* ... */
    }
}
--

// [slide=todo]
// exemples de noeuds du DOM avec des attributs

// [slide=todo]
// exemples de noeuds du DOM avec des propriÃ©tÃ©s non string/boolean
//* RO https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/dataset
//* RO https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/style

// [slide=todo]
// exemples de noeuds du DOM avec des mÃ©thodes
//* https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/focus
//* https://developer.mozilla.org/en-US/docs/Web/API/HTMLFormElement/submit
//* https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/pause
//* https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toDataURL
//* https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toBlob

// [slide=todo]
// exemples de noeuds du DOM avec des Ã©vÃ©nements un peu custom
//* https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/loadstart_event
//* https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/error_event

image::img/drawings/bookshelf-wc-ce.jpg[]
//oÃ¹ Ã§a se place dans notre tableau de solutions ?
//systÃ¨me de composant (API + runtime)

.Custom Elements
[slide=web-components, display=0]
* ğŸ¤” No customized built-in elements in Safari
* ğŸ˜ No real "data-binding" on properties (getter/setter or proxy)
* ğŸ˜¡ No HMR (without hacks)
* ğŸ“œ Scoped CustomElementRegistry
* ğŸ“œ Form associated elements
* ğŸ“œ Lazy definition

.Custom Elements
[slide=web-components, display=1]
* ğŸ¤” No customized built-in elements in Safari
* ğŸ˜ No real "data-binding" on properties (getter/setter or proxy)
* ğŸ˜¡ No HMR (without hacks)
* ğŸ“œ Scoped CustomElementRegistry
* ğŸ“œ Form associated elements
* ğŸ“œ Lazy definition

.Custom Elements
[slide=web-components, display=2]
* ğŸ¤” No customized built-in elements in Safari
* ğŸ˜ No real "data-binding" on properties (getter/setter or proxy)
* ğŸ˜¡ No HMR (without hacks)
* ğŸ“œ Scoped CustomElementRegistry
* ğŸ“œ Form associated elements
* ğŸ“œ Lazy definition

.Custom Elements
[slide=web-components, display=3]
* ğŸ¤” No customized built-in elements in Safari
* ğŸ˜ No real "data-binding" on properties (getter/setter or proxy)
* ğŸ˜¡ No HMR (without hacks)
* ğŸ“œ Scoped CustomElementRegistry
* ğŸ“œ Form associated elements
* ğŸ“œ Lazy definition

.Custom Elements
[slide=web-components, display=4]
* ğŸ¤” No customized built-in elements in Safari
* ğŸ˜ No real "data-binding" on properties (getter/setter or proxy)
* ğŸ˜¡ No HMR (without hacks)
* ğŸ“œ Scoped CustomElementRegistry
* ğŸ“œ Form associated elements
* ğŸ“œ Lazy definition

.Custom Elements
[slide=web-components, display=5]
* ğŸ¤” No customized built-in elements in Safari
* ğŸ˜ No real "data-binding" on properties (getter/setter or proxy)
* ğŸ˜¡ No HMR (without hacks)
* ğŸ“œ Scoped CustomElementRegistry
* ğŸ“œ Form associated elements
* ğŸ“œ Lazy definition

.Custom Elements
[slide=web-components, display=6]
* ğŸ¤” No customized built-in elements in Safari
* ğŸ˜ No real "data-binding" on properties (getter/setter or proxy)
* ğŸ˜¡ No HMR (without hacks)
* ğŸ“œ Scoped CustomElementRegistry
* ğŸ“œ Form associated elements
* ğŸ“œ Lazy definition

.Shadow DOM
[slide=web-components]
_
//shadow DOM => isolation du CSS

image::img/drawings-optimized/web-component-slot.svg[]

image::img/drawings-optimized/web-component-events.svg[]

image::img/drawings-optimized/web-component-sd.svg[]

la suite de l'API standard entrÃ©e/sortie (custom prop, ::part)
systÃ¨me de slots :+1
transperce le shadow root avec des custom props
transperce le shadow root avec des ::part (et ::theme)

// [slide=todo]
// exemples de noeuds du DOM avec des ::part ou des custom prop

image::img/drawings/bookshelf-wc-sd.jpg[]

oÃ¹ Ã§a se place dans notre tableau de solutions ?
systÃ¨me de composants
isolation du CSS

.Shadow DOM
[slide=web-components, display=0]
* ğŸ˜¡ No SSR (without hacks)
* ğŸ“œ Declarative shadow DOM, custom elements
* ğŸ“œ Custom pseudo class
* ğŸ“œ CSS modules

.Shadow DOM
[slide=web-components, display=1]
* ğŸ˜¡ No SSR (without hacks)
* ğŸ“œ Declarative shadow DOM, custom elements
* ğŸ“œ Custom pseudo class
* ğŸ“œ CSS modules

.Shadow DOM
[slide=web-components, display=2]
* ğŸ˜¡ No SSR (without hacks)
* ğŸ“œ Declarative shadow DOM, custom elements
* ğŸ“œ Custom pseudo class
* ğŸ“œ CSS modules

.Shadow DOM
[slide=web-components, display=3]
* ğŸ˜¡ No SSR (without hacks)
* ğŸ“œ Declarative shadow DOM, custom elements
* ğŸ“œ Custom pseudo class
* ğŸ“œ CSS modules

.Shadow DOM
[slide=web-components, display=4]
* ğŸ˜¡ No SSR (without hacks)
* ğŸ“œ Declarative shadow DOM, custom elements
* ğŸ“œ Custom pseudo class
* ğŸ“œ CSS modules

.`<template>`
[slide=web-components]
_
// <template>, une maniÃ¨re "efficace" de cloner du DOM

.<template>
[source, language=html, subs="none"]
--
<template id="foobar">
  <div>Awesome!!</div>
</template>

const awesome = foobar.content.cloneNode(true);
parent.appendChild(awesome)
--

image::img/drawings/bookshelf-wc-tpl.jpg[]
//oÃ¹ Ã§a se place dans notre tableau de solutions ?
//pas vraiment Ã©quivalent Ã  la dÃ©finition de template qu'on a Ã©voquÃ© mais bon

.`<template>`
[slide=web-components, display=0]
* ğŸ˜¡ No interpolation or reactive "data-binding"
* ğŸ“œ Template instanciation (limited to simple values)
* ğŸ“œ HTML modules

.`<template>`
[slide=web-components, display=1]
* ğŸ˜¡ No interpolation or reactive "data-binding"
* ğŸ“œ Template instanciation (limited to simple values)
* ğŸ“œ HTML modules

.`<template>`
[slide=web-components, display=2]
* ğŸ˜¡ No interpolation or reactive "data-binding"
* ğŸ“œ Template instanciation (limited to simple values)
* ğŸ“œ HTML modules

.`<template>`
[slide=web-components, display=3]
* ğŸ˜¡ No interpolation or reactive "data-binding"
* ğŸ“œ Template instanciation (limited to simple values)
* ğŸ“œ HTML modules

image::img/screenshots/web-components-best-practices.jpg[url=https://developers.google.com/web/fundamentals/web-components/best-practices]

//comment surveiller la suite

image::img/screenshots/github-web-components.jpg[url=https://github.com/w3c/webcomponents]

image::img/screenshots/twitter-intenttoship.jpg[url=https://twitter.com/intenttoship]

image::img/screenshots/twitter-WebPlatformNews.jpg[url=https://twitter.com/WebPlatformNews]

// image::img/screenshots/github-tc39.jpg[url=https://github.com/tc39/proposals]

// des resources pour surveiller les specs et les implems dans les browsers
// TC39

//Est-ce que votre outil est prÃªt demain Ã  adopter un standard et jetter son implem pour vous faire profiter du support natif ?

[slide=blank]
Transition

Maintenant qu'on a dÃ©construit un peu les diffÃ©rentes solutions qu'apportent les frameworks et les standards,
on a une meilleure vision des diffÃ©rentes couches qui composent un projet Web,
et du coup, il est temps d'appliquer...

== A *SOLID* Web!

[.time]#00:30:00#
...les principes SOLID Ã  notre frontend prÃ©fÃ©rÃ©.
Je vais prendre l'exemple du travail que je fais en ce moment...

[quote]
Code should be disposable,   it's far easier to do when   things are decoupled.

.Our context at *Clever Cloud*
[.logo]
image::img/cc-rocket-man.png[]
//image::img/clever-cloud-logo.svg[]

...chez Clever Cloud,
en espÃ©rant que Ã§a vous donne des idÃ©es pour votre contexte et votre stack.

[slide=blank, data-viewport=1]
_

DÃ©mo console
Ã§a c'est ce qu'on appelle notre console,
c'est le tableau de bord qui permet Ã  nos clients d'administrer leurs apps, leurs bdd, leurs addons...
montrer la console web en dÃ©mo
(Ã©cran overview)
citer logs, monitoring...
(switcher sur les vars d'env)

image::img/drawings/bookshelf-cc-before.jpg[]

la stack Clever
...
codebase qui a 7 ans
Component system (sÃ©paration du code mais pas d'API ni de systÃ¨me runtime)
Templating (lodash)
CSS (global) avec qq rÃ¨gle de nommage parfois
DOM (jquery + bacon)
Pas de SSR
Router maison (merci quentin)
Pas vrmt de state manager (bacon)

.Our needs
[slide=web-components, display=0]
* ğŸ‘‹ Goodbye (Bacon.js + lodash templates)
* ğŸ’ª Components with an API and isolation
* â™»ï¸ Reusability (white label products)
* ğŸ¤¯ No feature less "big-bang" refactoring
* ğŸ”¢ Introduce new tools feature by feature

.Our needs
[slide=web-components, display=1]
* ğŸ‘‹ Goodbye (Bacon.js + lodash templates)
* ğŸ’ª Components with an API and isolation
* â™»ï¸ Reusability (white label products)
* ğŸ¤¯ No feature less "big-bang" refactoring
* ğŸ”¢ Introduce new tools feature by feature

.Our needs
[slide=web-components, display=2]
* ğŸ‘‹ Goodbye (Bacon.js + lodash templates)
* ğŸ’ª Components with an API and isolation
* â™»ï¸ Reusability (white label products)
* ğŸ¤¯ No feature less "big-bang" refactoring
* ğŸ”¢ Introduce new tools feature by feature

.Our needs
[slide=web-components, display=3]
* ğŸ‘‹ Goodbye (Bacon.js + lodash templates)
* ğŸ’ª Components with an API and isolation
* â™»ï¸ Reusability (white label products)
* ğŸ¤¯ No feature less "big-bang" refactoring
* ğŸ”¢ Introduce new tools feature by feature

.Our needs
[slide=web-components, display=4]
* ğŸ‘‹ Goodbye (Bacon.js + lodash templates)
* ğŸ’ª Components with an API and isolation
* â™»ï¸ Reusability (white label products)
* ğŸ¤¯ No feature less "big-bang" refactoring
* ğŸ”¢ Introduce new tools feature by feature

.Our needs
[slide=web-components, display=5]
* ğŸ‘‹ Goodbye (Bacon.js + lodash templates)
* ğŸ’ª Components with an API and isolation
* â™»ï¸ Reusability (white label products)
* ğŸ¤¯ No feature less "big-bang" refactoring
* ğŸ”¢ Introduce new tools feature by feature

sur certaines parties de l'app, on avait dÃ©jÃ  un modÃ¨le
comme les frameworks moderne avec un one way data flow
je modifie de la donnÃ©e, Ã§a par dans un stream bacon et Ã§a modifie le DOM
on a un peu atteint les limites de ce modÃ¨le bacon + lodash (perfs et modÃ¨le de pensÃ©e)
on a isolÃ© les "modules" dans des fichiers mais on a du CSS global et on a pas d'interface clairement dÃ©finie sur nos composants
on va avoir besoin que notre UI soit rÃ©utilisÃ©e en marque blanche ou marque grise
du coup, on doit pouvoir fournir certains parties de maniÃ¨re indÃ©pendantes un peu comme des lÃ©gos
// donnÃ©e qui vient d'appels REST et/ou de SSE
...
on va introduire des nouvelles technos feature aprÃ¨s feature
le fait que notre code n'Ã©tait pas enfermÃ© dans un framework nous facilite cette migration
Les commentaires, c'est pour tes collÃ¨gues, mais c'est surtout pr toi dans 6 mois un an. Les composants Web c'est pareil. C'est pour que des tiers puissent les utiliser dans d'autres contextes et pour que toi tu puisses changer ta stack dans 6 mois.

[slide=text]
Design phase:   from *top* to *bottom*

// [slide=todo]
// mock-up top => bottom des vars d'env

[slide=text]
Development phase:   from *bottom* to *top*

les enfants ne savent pas qui les utilisent
mais ils ont une idÃ©es de comment ils seront utilisÃ©s ou plutÃ´t de ce qu'ils doivent faire
les parents savent Ã  quoi servent leur enfants mais ne se soucis pas de comment Ã§a marche Ã  l'interieur
tu ne sais pas qu'il y a un router
tu ne sais pas qu'il y a un state manager
tu ne sais pas d'oÃ¹ vient la donnÃ©e

[slide=text]
*Storybook* **D**riven **D**evelopment

YOU NEED A DESIGN SYSTEM

//image::img/talk-storybook-ml-thuret.jpg[url=https://www.youtube.com/watch?v=a-fsVBaiv5A]
image::img/talk-storybook-ml-thuret.en.jpg[]

[slide=blank, data-viewport=2]
DÃ‰MO: le storybook de clever

DÃ‰MO: le storybook de clever
montrer les boutons avec leur interface
montrer le composant env-var-input
montrer le composant env-var-editor-simple
montrer le composant env-var-editor-expert
expliquer qu'ils ont la mÃªme signature et son donc trÃ¨s facilement interchangeable aux yeux du parent

image::img/drawings/bookshelf-cc-after.jpg[]

: web component pour la rÃ©utilisabilitÃ© et le cÃ´tÃ© agnostique du fwk et l'aspect standard
: lit-element + lit-html (petites libs)
: on en a testÃ© d'autres mais celles si nous convenait le mieux

image::img/screenshots/site-lit-html.jpg[url=https://lit-html.polymer-project.org/]

.lit-html
[source, language=javascript, subs="none"]
--
import { html, render } from 'lit-html';

let envVarInput = (envVar) => html`
    <span class="name">${envVar.name}</span>
    <input name=${envVar.name} .value=${envVar.value}>
`;

render(envVarInput({ name: 'FOO', value: 'BAR' }), someDomNode);
--

image::img/screenshots/site-lit-element.jpg[url=https://lit-element.polymer-project.org/]

.LitElement
[source, language=javascript, subs="none"]
--
import { LitElement, html } from 'lit-element';

class EnvVarInput extends LitElement {

  render() {
    return html`
      <!-- My template here -->
    `;
  }
}

customElements.define('env-var-input', EnvVarInput);
--

//[slide=text]
//SÃ©paration des *prÃ©occupations*   #â‰ #   SÃ©paration des *fichiers*
//SÃ©paration des *prÃ©occupations*   #!==#   SÃ©paration des *fichiers*
//SÃ©paration des *prÃ©occupations*  *!==* SÃ©paration des *fichiers*

// [quote]
// The more experienced a developer is, the less they are willing to be constraint by a framework. They tend to look for tools that help them and get out of the way.
// https://hueniverse.com/http-frameworks-must-die-717a37b6b164

image::img/drawings-optimized/layers-mixed-light.svg[]

image::img/drawings-optimized/layers-light.svg[]

layer data aware
layer auth aware
elements qui font des appels REST

// [slide=todo]
// remonter l'accÃ¨s Ã  la donnÃ©e le plus haut possible

.Reduce coupling with global stuffs
[slide=web-components]
* Router
* Data management (REST, WS, SSE...)
* State management
* Loading indicators
* Messages, notifs (info, error...)
* Modal box
* Keyboard shortcuts
//* document.title
// i18n

// i18n
// packaging
// Tests: do it like a  screen reader user wood do it
// Tests: no a great fan of snapshots

[slide=text]
Did we choose the *right tool*?

[.osef, slide=text]
*IDGASâ„¢ï¸*

[slide=text]
Not the *right* question!

[slide=text]
How much does it *cost*   to *change* our minds?

Est-ce qu'on a fait le bon choix avec cette stack ?
Oui, pas au sens ou on a choisi la bonne solution.
Au sens ou on pourra changer d'avis demain,
garder des composants longtemps avec ce choix sans les retoucher, et tant pis car ils sont petit
les rÃ©Ã©crire avec des outils diffÃ©rents car l'impact sur les autres couches sera faible.
On s'en fout !
On a fait un choix qui ne nous demande pas trop d'apprentissage spÃ©cifique (lit-element, lit-html),
qui nous donne des connaissances de nouveaux standards du Web,
Ã§a ne peut qu'Ãªtre positif !

[slide=blank]
Transition

== Looking into  the *future*...


[.time]#00:40:00#

[slide=text]
*Beware* of those who   predict the future**!**

//See WC as the bytecode of the component isolation concept. It can be a compile to target
//People don't have to worry on the sugar

image::img/screenshots/article-frameworks-without-the-framework.jpg[url=https://svelte.technology/blog/frameworks-without-the-framework]

Vous pensez que 100k de JS, c'est pareil que 100k d'image => faux
Le JS est tÃ©lÃ©chargÃ©, parsÃ©, Ã©xÃ©cutÃ©, tout Ã§a, Ã§a prend du temps.

image::img/screenshots/article-compilers-are-the-new-frameworks.jpg[url=https://tomdale.net/2017/09/compilers-are-the-new-frameworks/]

//image::img/screenshots/tweet-future-web-assembly.jpg[url=https://twitter.com/getify/status/1111004737263075329]

//* le i18n (inlinÃ©)
//Discuter des webcomponent comme base pour l'authoring ou comme target de compilation

//[slide=todo-screenshot]
//Web Assembly

image::img/drawings/browser-12.jpg[]

image::img/drawings/browser-13.jpg[]

image::img/drawings/browser-14.jpg[]

framework runtime => compilers
schÃ©ma browser avec le code qui passe du runtime au build
bon ou mauvais ?
l'idÃ©al serait que l'input du compiler fonctionne sans build step et que l'output soit optimisÃ© aux petits oignons, comme ce qu'on fait quand on minifie
schÃ©ma browser avec le code qui passe du runtime et vers des implem du browser
...
Convaincre les gens que :
Le passÃ© se rÃ©pÃ¨te
Les outils vont et viennent
La constante, c'est le modÃ¨le des Ã©lÃ©ments du DOM (sorte de HDMI du Web)
Tout comme on a appris Ã  apprendre mais on garde certaines bases fondamentales, ils faut capitaliser sur les bases fondamentales (le web et ses standards) et adopter des facilitants par dessus avec une courbe d'apprentissage
// Ne pas hÃ©siter Ã  questionner les standards ou les frameworks Ã  la mode
// Qu'est-ce qui est important ? L'UX, la DX, les perfs ?
// On est trop dÃ©pendant de nos outils
// On est pas tjs assez exigent avec nos outils
// Il faut plus de compilation (html, css, js) et donc une Ã©tape intermÃ©diaire
// Ã‡a facilite le SSR, le HMR, plus rÃ©silient aux vieux browsers
// Compiler le i18n

[.stop-music.dark, slide=blank]
Fondu vers le noir

[.old.play-music]
== ...Epilogue

[.time]#00:42:00#

.So?
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-talks.svg[]

ğŸ‘©â€âš•ï¸ So? How was your group therapy?
ğŸ˜ I don't know, it didn't have time to go into each details so instead,
I tried to share the way I see things so people can adapt to their own context.

.Problem #1
[slide=problem]
Finding solutions   to problems we don't have (yet)

ğŸ˜ For problem number 1,
I tried to insist and move the focus back on needs:
1. Needs of the people using the products we build
2. Needs of the development team who works on the project
...
Un navigateur Web est devenu aujourd'hui, *une plateforme applicative assez complexe*.
Bien sÃ»r qu'on a besoins d'outils Ã  la hauteur des enjeux. L'idÃ©e n'est pas de tout faire Ã  la main et de rÃ©inventer la roue.
AprÃ¨s, Ã§a veut pas dire qu'on a tous les mÃªmes contextes et les mÃªmes prioritÃ©s.
...
J'espÃ¨re que les gens auront le rÃ©flexe :
* "ah un nouvel outil qui brille !"
* "Ã§a rÃ©soud quel problÃ¨me ?"
* "est-ce que j'ai ce problÃ¨me ?"
et de savoir :
* ce que vous codez
* et avec qui vous codez

.Problem #2
[slide=problem]
Getting locked into our own ecosystem

ğŸ˜ J'ai aussi essayÃ© de dÃ©construire les diffÃ©rentes fonctionnalitÃ©s/solutions qu'apportent des 3 Ã©cosystÃ¨mes du moment.
L'idÃ©e principale est bien d'avoir un regard plus critique et une vision horizontale plutÃ´t qu'une vision verticale.
Pour ma part, en comprenant mieux ces parties, j'ai moins peur des les remplacer par des implems plus simples ou mieux adaptÃ©s ou pars des nouveaux standards.
En fait, au final, tous ces frameworks, ces librairies et ces standards, Ã§a n'est que des outils.
On a juste besoin de tous rester calmes et professionnels,
les utiliser pour les supers fonctionnalitÃ©s qu'ils nous apportent
et arrÃªter de les idÃ´latrer aveuglement.
ğŸ‘©â€âš•ï¸ Et vous leur avez parlÃ© des TV magnÃ©toscopes

.Problem #3
[slide=problem]
Writing strongly coupled code   that does not age well with time

ğŸ˜ Oui, j'ai expliquÃ© comment chez Clever Cloud on essaye de rÃ©duire le couplage entre nos diffÃ©rents composants, modules et couche applicatives.
J'ai Ã©voquÃ© ce que Ã§a nous apporte dans notre contexte bien prÃ©cis.
On a rien inventÃ©, on essaye d'appliquer les bons vieux patterns logiciels au Web moderne.
Ã‡a reste un principe, il y a tjs des exceptions.
L'idÃ©e n'est pas de quadrupler les coÃ»ts de conception juste pour faire du "beau code" mais bien d'investir un minimum d'Ã©nergie pour rÃ©duire les effets du temps.

.Thanks doctor!
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-love.svg[]

ğŸ˜ Je vous remercie docteur, Ã§a m'a bien aidÃ©
et je tiens Ã©galement Ã  remercie tous les membres du groupe qui m'ont Ã©coutÃ© jusqu'au bout.

.thank  you !
[.reset-music, slide=poster]
Outro

Merci bcp.

//[slide=question]
//Questions ?
