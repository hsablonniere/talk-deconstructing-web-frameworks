= the  Web,  its  Frameworks,  and its  Standards : deconstructing them for a more resilient code base...
Hubert SablonniÃ¨re
:author-twitter: @hsablonniere
:author-avatar: img/hsablonniere-profil-2017.jpg
:author-company: Clever Cloud
:author-company-logo: img/clever-cloud-logo.svg
:event: Voxxed CERN
:date: may 1st, 2019

[slide=poster]
Poster

[.time]#00:00:00#

[.stop-music.dark, slide=blank]
Fading to black


[.old.play-music]
== Prologue...

#Wait for music#
#Deep and sad voice#
Wandering in the jungle of the modern Web,

image::img/drawings-optimized/thinking.svg[]

our main character is lost.
Since he started his career, weeks after weeks, years after years,

image::img/drawings-optimized/thinking-words.svg[]

he saw the birth of many revolutionary and promising tools,
but tomorrow, maybe, those could all vanish and be replaced by new ones ... *even more better*.
It is with lots of sadness and a bit of melancholia that he remembers all these frameworks, librairies, code editors and other command line tools.

image::img/drawings-optimized/rip.svg[]

#Whisper#
Please show some respect!
If they haven't already disappeared from our projects,
maybe they already have disappeared from our...

image::img/drawings-optimized/radar.svg[]

coolness radards.
This situation worries him and keeps him up at nights.
In his current job, he has to make technical choices, yet he doesn't know what to do anymore.
It is at this very moment that our main character decided to see...

[.reset-music]
image::img/drawings-optimized/dr-sigma.svg[]

...a therapist.
[.four]#Restart la musique (Gymnopedie)#

image::img/drawings-optimized/talking-legos.svg[]

#Tired and sad voice#
ğŸ˜ Hello doctor.
#Confident voice#
ğŸ‘©â€âš•ï¸ Hello Mr SablonniÃ¨re? So? What can I do for you?
Last time I saw you, it was like 10 years ago...
You just started your first job and you had some kind of PTSD about wether to use "spaces or tabs" and on the pronunciation of "animated guiffs".
#Like a millenial#
ğŸ˜ You mean djifs, right?

.2 spaces,   it's better!
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-thinks.svg[]

#Brag about being a senior dev#
ğŸ˜ Yeah but that's all in the past now, I was young, I wasn't asking myself the right questions.
I recently took a few steps back about the frontend Web and I made an observation:

.Too much hype,   we've become addicts!
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-talks.svg[]

ğŸ˜ There's way too much hype around tools and we've all become addicted to them.
ğŸ‘©â€âš•ï¸ Humm, tell me more, what kind of problems does it imply?

image::img/drawings-optimized/projecteur.svg[]

#Energy voice#
ğŸ˜ So, problem number 1...
#Surprised voice#
ğŸ‘©â€âš•ï¸ Hummm... when someone asks you a question, do you always answer with a PowerPoint?

.I AM NOT   using PowerPoint!
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-thinks.svg[]

#Really happy#
ğŸ˜ Oh yeah! It's very handy, you know.
#Steps down#
Anyway.

.Problem #1
[slide=problem]
Finding solutions   to problems we don't have (yet)

ğŸ˜ Problem number 1...
When we choose a framework, a frontend library and its ecosystem, we often forget the original problem we wanted to solve.
*And yet*, we feel like we already found *the right answer*, *the right solution* to use.
Most of the time, it's the right tool for the right job but sometimes, the solution was designed to solve problems we don't really have.

.Why?
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-talks.svg[]

ğŸ‘©â€âš•ï¸ Why on earth would you do that?

image::img/drawings-optimized/dx-ux.svg[]

ğŸ˜ Well, sometimes it's because it's **cool**!
But it forces us to put the developer experience before the user experience,
the user of the very product we're trying to build.

image::img/drawings-optimized/giant.svg[]

ğŸ˜ Sometime it's because it's used or even created by a Web giant, one of the big 5. Oh yeah!
// Ã‡a forme un cycle:
// * les gÃ©ants l'utilisent
// * on l'utilise
// * les recruteurs nous attirent avec
// * les dÃ©butants se forment dessus
// * on crÃ©Ã© des confs dÃ©diÃ©es
// * on crÃ©Ã© des meetups

.Go on, go on... !
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-talks.svg[]

ğŸ‘©â€âš•ï¸ Go on, go on...

.Problem #2
[slide=problem]
Getting locked into our own ecosystem

ğŸ˜ Problem number 2...
Once we chose an ecosystem, we tend to get locked into it.
// https://en.wikipedia.org/wiki/Escalation_of_commitment
// https://fr.wikipedia.org/wiki/Escalade_d%27engagement
// https://en.wikipedia.org/wiki/Sunk_cost
// https://fr.wikipedia.org/wiki/Co%C3%BBt_irr%C3%A9cup%C3%A9rable

image::img/drawings-optimized/silos.svg[]

ğŸ˜ We open a specific door and we stay cosy inside without looking outside, at what others do.
This means we're going to look for "how to do X or Y" with *THIS* ecosytem even if X or Y a pretty much universal frontend problems.
A bit like when we wanted to maniulate arrays or dates with jQuery.
We're going to rewrite yet another "select" or "datagrid" component dedicated to this ecosystem.
We'll prefix all our stackoverflow questions with "angular", "react" or "vue".
And like all fanboys/fangirls,
we don't always see the limitations of what we love,
and we convince ourselves that we need those shiny new features without understanding them very well.

image::img/drawings-optimized/brain.svg[]

ğŸ˜ We're going to fill our brains with...

image::img/drawings-optimized/brain-fwk.svg[]

ğŸ˜ ...features and concepts specific to our own ecosystem...
// ğŸ˜ Difficile de changer de cap quand on a investi du temps d'apprentissage.

image::img/drawings-optimized/brain-patterns.svg[]

ğŸ˜ ...instead of filling them with well known standards and patterns.

.Oh, so just like   Apple keynotes?
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-thinks.svg[]

ğŸ‘©â€âš•ï¸ Hum, hum, I see...
// Ah vous entendre, on dirait mon fils devant une confÃ©rence Apple, quand ils sortent l'iPod ou l'iPhone, je comprends qu'il soit Ã©merveillÃ©
// Mais quand Apple dit "on a virÃ© le jack" il dit, "ah mais ces vraiment des gÃ©nies" alors qu'il a pas de casque bluetooth
// Rant sur les exemples de code dÃ©corÃ©s apple

.Problem #3
[slide=problem]
...

ğŸ˜ Problem number 3...
This one is pretty universal,
We easily forget the basics, the patterns and best practices like SOLID or "separation of concerns".

.Problem #3
[slide=problem]
Writing strongly coupled code   that does not age well with time

We tend to write code that is strongly coupled and that does not age well with time.

image::img/drawings-optimized/layers.svg[]

ğŸ˜ Instead of having well defined and isolated layers...

image::img/drawings-optimized/layers-mixed.svg[]

ğŸ˜ ...we write modules that mix several responsibilities and we couple our code to the implementation of global stuffs in the project.
In the end,
* when our own ecosystem evolves,
* when it disappears,
* or when a new standard rises,
it becomes very hard to replace pieces one at a time.

image::img/drawings-optimized/trash.svg[]

ğŸ˜ We're going to throw away...

image::img/drawings-optimized/trash-brain.svg[]

ğŸ˜ ...parts of our knowledge...

image::img/drawings-optimized/trash-project.svg[]

ğŸ˜ ...and lots of code.

.#FeatureLessRefactoring
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-talks.svg[]

Hashtag "I love feature less refactors"

.WTF?
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-talks.svg[]


ğŸ‘©â€âš•ï¸ OK, I'm completely lost.
ğŸ˜ Ah...
Humm, it's a but like my TV.

.Just like my TV!
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-talks.svg[]

ğŸ˜ Last time I went to see you 10 years ago,
I just started my first job but I also just bought a new TV with my internship money.

image::img/drawings-optimized/tv.svg[]

ğŸ˜ I still have this TV,
and it works *just* like it did 10 years ago.
Its still working and relevant because it only does one thing and it does it well.
It doesn't know what I'm going to plug into it, it just enforces an interface : HDMI.

image::img/drawings-optimized/tv-pc.svg[]

ğŸ˜ At first, I plugged a huge desktop computer with some movies,

image::img/drawings-optimized/tv-raspberry.svg[]

ğŸ˜ then I went for a smaller one.
I plugged many different devices that didn't exist back then,
but it worked.

image::img/drawings-optimized/tv-androidtv.svg[]

ğŸ˜ I even discovered by accident that on top of receiving audio/video via HDMI,
it could send signals (via HDMI-CEC) to source devices.
Anyway, today, when I look at frontend projects...

image::img/drawings-optimized/tv-vcr.svg[]

ğŸ˜ I see *this!*
ğŸ‘©â€âš•ï¸ Oh yeah, TV+VCR combos!
I had one of those! It was really handy, you didn't have to worry about configuration and wires, it was almost magical.
But when our VCR broke, we had to throw both away and buy something new.

// image::img/drawings-optimized/tv-vcr-real.svg[]

.Ah, you see?
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-talks.svg[]

ğŸ˜ Oh, so you see what I mean?
ğŸ˜ You see why I'm lost?

.OK, OK, I see...
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-talks.svg[]

ğŸ‘©â€âš•ï¸ OK, OK, I see...
The best solution in your case...

.Group therapy!
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-talks.svg[]

ğŸ‘©â€âš•ï¸ ...is group therapy with profesionnals from your industry !
so I gathered a small group of people here.

.I'll go   but I'm scared!
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-thinks.svg[]

ğŸ˜ Well... it's not what I call a small group...

.Everything's    gonna be alright!
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-talks.svg[]

ğŸ‘©â€âš•ï¸ Don't worry, everything's gonna be alright!

[.stop-music, slide=poster]
Hello

[.time]#00:06:00#
Hello everyone!
I'm Hubert SablonniÃ¨re,
I'm a Web Developer at #Clever Cloud#,
and today, I want to talk about:
* the Web,
* its frameworks and librairies
* and its standards.
A very simple topic without any polemics or drama.
We're gonna try to deconstruct all this
in the hope of building better web apps tomorrow.

[slide=blank]
Transition

OK, so everyday, we're using super cool & shiny tools that bring us solutions...

== What was the  *problem* anyway?

[.time]#00:06:30#
...but what was the problem anyway?
...
In this part, I tried to list the main problems I encountered during my many experiences working on Web projects.

[slide=needs, display=0]
_

On one side, we have the problems we want to solve for the users of the product we're building,
on the other side, we have the problems *WE* face,
...
So, as a user, I want:

[slide=needs, display=1]
_

A *blazing* fast first load.
Un 1er chargement rapide.

[slide=needs, display=2]
_

Once the page is loaded,
I want following navigations to be as fast.

[slide=needs, display=3]
_

I want the web app to be smooth and reactive,

[slide=needs, display=4]
_

I don't smart usage of my battery, CPU and RAM,

[slide=needs, display=5]
_

I want it to be accessible to everyone,

[slide=needs, display=6]
_

and everywhere.
...
Here, we already see that the context is key.
The importance of those problems depends on *what you are coding*.
If you're working on something where the user is active (like gMail or Slack), a fast first load is not your main problem.
Same for the opposite case, if you work on something where the user mainly does reading and navigation,
having 60 fps refreshes and animations may not be a problem you have.
...
On our side, as developers, we want:

[slide=needs, display=7]
_

to save time, without reinventing the wheel,

[slide=needs, display=8]
_

to write clean and reusable code,

[slide=needs, display=9]
_

with abstractions to keep a simple thinking model.

[slide=needs, display=10]
_

We want to isolate the impacts when we change stuffs,
On veut une isolation des impacts de nos changements,

[slide=needs, display=11]
_

to avoir some errors and bugs as early as possible...
and small bonus,

[slide=needs, display=12]
_

if we can collaborate with muggles, non-devs, it's nice.
...
Here, the importance of those problems depends on *with whom you're coding*, your team, its experience.
You may not have the same team as the Big 5 or the latest 2 persons start-up.

[slide=blank]
Transition

OK, so if you're a backend dev and you were a bit behind what happened in the frontend in the past few years,
you may think:
"OK Hubert, you just listed basically the same problems we've been trying to solve for the past 10 years."
"Web should be simple, you frontend people really made things complex for the sake of it."
...
Ah, ah, ah... backend devs saying frontend is too complex.
OK, let's put the irony of this remark on the side,
and let's really ask the question:

== *How* did we  get here?

[.time]#00:08:00#
How did we get here?
Do we really need all those complex tools?

[quote]
In order to understand where we're going,   we need to know where we come from.

In order to understand where we're going, we need to know where we come from.
#blasÃ©#
I don't remember who said that, #sorry,
but he or she's definitely right!

image::img/drawings/browser-1.jpg[]

At the beginning of the Web, we had simple but powerful conceps.
A user asks for a URL to the browser,
the browser does an HTTP request to the server,
the server applies a template and answers with an HTML document,
OK, thank you, bye bye.

image::img/drawings/browser-2.jpg[]

Then we added images, and CSS and also forms,
The first time the user could interract with the document after first load.
// click
// POST
// nouvelle page HTML

image::img/drawings/browser-3.jpg[]

Then JavaScript arrived and we opened the door of complexity.
First time we had the possibility as devs to react directly to user inputs,
without server round trips.
We started with simple DOM manipulation.

image::img/drawings/browser-4.jpg[]

Then came the AJAX era with jQuery and friends,
and we started to do more and more with this JavaScript,

image::img/drawings/browser-5.jpg[]

We did AJAX calls to fetch some server side templated HTML,
then we only fetched JSON and did the templating client side,
and finally, we did routing on the client side too.
We were improving the experience once the page was loaded but...

image::img/drawings/browser-6.jpg[]

...this JavaScript-mania came to the *empty-body-megabytes-of-js era*
Which meant:
* more and more code to download
* more and more code to parse
* more and more code to execute
* first load was bad
* and too much stuffs relying on JS code to run well

image::img/drawings/browser-7.jpg[]

Today, all of our tooling is here to help us write good code but also to try to get the best of both
having a first load rendered on the server side, downloading only what's necessary,
and load the rest piece by piece.

image::img/drawings/browser-8.jpg[]

And all of this happened during this phase where we saw mobile Web take off and getting browser storage, workers etc...

image::img/drawings/browser-9.jpg[]

image::img/drawings/browser-10.jpg[]

image::img/drawings/browser-11.jpg[]

[slide=blank]
Transition

Those problems are complex so I'm asking the question:

== What do *frameworks*  bring to the table?

[.time]#00:10:00#

What do *frameworks* bring to the table?
What would I miss if I were writing only "vanilla JS"?

[slide=text]
*Frameworks* vs. *libs* ?

framework => cadre de travail
opinionated set of libs/tools
problem is when this set of libs/tools is only compatible with itself
in my experience, projects with frameworks X ou Y don't look alike that much when the context is different,
...
historique
jquery
Frameworks are also their to prevent browser quirks

[slide=todo-schema]
image::img/drawings-optimized/silos-colors.svg[]

Angular and ember are opinionated
React is supposed to be unopinionated
Vue is a bit in the middle
special mention to ember

[slide=todo-schema]
image::img/drawings-optimized/silos-rooms.svg[]

[slide=blank]
on efface

image::img/drawings/bookshelf-empty.jpg[]

// mentionner les Ã©tapes qui nÃ©cessitent un outil de build
// est-ce que la source de l'outil de build est spÃ©cifique ou est-elle un peu standard ?
// mentionner des dÃ©tails sur les implÃ©mentations

// points importants Ã  aborder

[slide=needs, focus=""]
Component system (API + runtime)

[slide=needs, focus="7,9"]
Component system (API + runtime)

image::img/drawings/bookshelf-1.jpg[]

Angular et Vue "data down, events up"
=> methods
React "data down, action up" (ou callback called)
=> props pour les children
Tous: attrs et lifecycle methods
Slots ?

[slide=needs, focus=""]
"Templating" / ViewModel

[slide=needs, focus="0,6,7,8,9,10,11"]
"Templating" / ViewModel

image::img/drawings/bookshelf-2.jpg[]

=> JSX, templates
=> 1 file vs several files
=> output pur JS, vs JS + CSS
Mvc, mvvm, template + vue model, computed properties
exemple Angular, React, Vue

[slide=needs, focus=""]
CSS authoring

[slide=needs, focus="0,9"]
CSS authoring

image::img/drawings/bookshelf-3.jpg[]

=> BEM, CSS-in-JS lib, encapsulation system

[slide=needs, focus=""]
DOM manipulation

[slide=needs, focus="2,3,4,5,8"]
DOM manipulation

image::img/drawings/bookshelf-4.jpg[]

=> Direct binding vs Virtual DOM (+ scheduling microtask...)
The Virtual DOM was always a big marketing argument to sell React but why would we care.
It's an implementation detail an clearly, if they changed their impl and are still fast, we should not care at all.

[slide=needs, focus=""]
SSR (Server Side Rendering)

[slide=needs, focus="0,5"]
SSR (Server Side Rendering)

image::img/drawings/bookshelf-5.jpg[]

[slide=needs, focus=""]
Router

[slide=needs, focus="1"]
Router

image::img/drawings/bookshelf-6.jpg[]

[slide=needs, focus=""]
State manager

[slide=needs, focus="7,8"]
State manager

image::img/drawings/bookshelf-7.jpg[]

image::img/drawings/bookshelf-8.jpg[]

en vrac car moins important pour notre discussion
CLI
Devtools
HTTP client
Form handling
Module system
Dep inj
i18n
tests

[slide=blank]
Transition

All those frameworks/ecosystems have interesting solutions for modern Web projects,
but again, they may solve problems you don't have or they may solve them for some kind of devs you don't have in your team.
...
Because I often here, browsers should just put react in the browser and be done with it,
I'm going to address the question:

== What do *standards*  bring to the table?

[.time]#00:20:00#
What do *standards* bring to the table?

image::img/screenshots/site-jquery.jpg[url=https://jquery.com/]

prÃ©ambule exemple jquery => sizzle + ajax + API chainÃ©e sucre syntaxique

// [slide=todo]
// schÃ©ma cycle

.Web Components
[slide=web-components]
_

image::img/drawings-optimized/web-component-tv.svg[]
// UTILISER LE SCHEMA DE LA TV
schÃ©ma de la tÃ©lÃ© => analogie avec le Web component

image::img/drawings-optimized/web-component.svg[]

.Custom Elements
[slide=web-components]
_
// custom element => modÃ¨le de composant avec lifecycle methods et "data binding" sur les attributs

.Custom Element
[source, language=javascript, subs="none"]
--
class EnvVarInput extends HTMLElement {
    /* ... */
}

customElements.define('env-var-input', EnvVarInput);

<env-var-input name="FOO" value="BAR"></env-var-input>
--

image::img/drawings-optimized/web-component-attr.svg[]

image::img/drawings-optimized/web-component-prop.svg[]

image::img/drawings-optimized/web-component-methods.svg[]

image::img/drawings-optimized/web-component-events.svg[]

.Custom Element
[source, language=javascript, subs="none"]
--
class EnvVarInput extends HTMLElement {
    connectedCallback() {
        /* ... */
    }
    disconnectedCallback() {
        /* ... */
    }
    adoptedCallback() {
        /* ... */
    }
}
--

.Custom Element
[source, language=javascript, subs="none"]
--
class EnvVarInput extends HTMLElement {
    static get observedAttributes() {
        return ['name', 'value'];
    }
    attributeChangedCallback() {
        /* ... */
    }
}
--

// [slide=todo]
// exemples de noeuds du DOM avec des attributs

// [slide=todo]
// exemples de noeuds du DOM avec des propriÃ©tÃ©s non string/boolean
//* RO https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/dataset
//* RO https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/style

// [slide=todo]
// exemples de noeuds du DOM avec des mÃ©thodes
//* https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/focus
//* https://developer.mozilla.org/en-US/docs/Web/API/HTMLFormElement/submit
//* https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/pause
//* https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toDataURL
//* https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toBlob

// [slide=todo]
// exemples de noeuds du DOM avec des Ã©vÃ©nements un peu custom
//* https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/loadstart_event
//* https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/error_event

image::img/drawings/bookshelf-wc-ce.jpg[]
//oÃ¹ Ã§a se place dans notre tableau de solutions ?
//systÃ¨me de composant (API + runtime)

.Custom Elements
[slide=web-components, display=0]
* ğŸ¤” No customized built-in elements in Safari
* ğŸ˜ No real "data-binding" on properties (getter/setter or proxy)
* ğŸ˜¡ No HMR (without hacks)
* ğŸ“œ Scoped CustomElementRegistry
* ğŸ“œ Form associated elements
* ğŸ“œ Lazy definition

.Custom Elements
[slide=web-components, display=1]
* ğŸ¤” No customized built-in elements in Safari
* ğŸ˜ No real "data-binding" on properties (getter/setter or proxy)
* ğŸ˜¡ No HMR (without hacks)
* ğŸ“œ Scoped CustomElementRegistry
* ğŸ“œ Form associated elements
* ğŸ“œ Lazy definition

.Custom Elements
[slide=web-components, display=2]
* ğŸ¤” No customized built-in elements in Safari
* ğŸ˜ No real "data-binding" on properties (getter/setter or proxy)
* ğŸ˜¡ No HMR (without hacks)
* ğŸ“œ Scoped CustomElementRegistry
* ğŸ“œ Form associated elements
* ğŸ“œ Lazy definition

.Custom Elements
[slide=web-components, display=3]
* ğŸ¤” No customized built-in elements in Safari
* ğŸ˜ No real "data-binding" on properties (getter/setter or proxy)
* ğŸ˜¡ No HMR (without hacks)
* ğŸ“œ Scoped CustomElementRegistry
* ğŸ“œ Form associated elements
* ğŸ“œ Lazy definition

.Custom Elements
[slide=web-components, display=4]
* ğŸ¤” No customized built-in elements in Safari
* ğŸ˜ No real "data-binding" on properties (getter/setter or proxy)
* ğŸ˜¡ No HMR (without hacks)
* ğŸ“œ Scoped CustomElementRegistry
* ğŸ“œ Form associated elements
* ğŸ“œ Lazy definition

.Custom Elements
[slide=web-components, display=5]
* ğŸ¤” No customized built-in elements in Safari
* ğŸ˜ No real "data-binding" on properties (getter/setter or proxy)
* ğŸ˜¡ No HMR (without hacks)
* ğŸ“œ Scoped CustomElementRegistry
* ğŸ“œ Form associated elements
* ğŸ“œ Lazy definition

.Custom Elements
[slide=web-components, display=6]
* ğŸ¤” No customized built-in elements in Safari
* ğŸ˜ No real "data-binding" on properties (getter/setter or proxy)
* ğŸ˜¡ No HMR (without hacks)
* ğŸ“œ Scoped CustomElementRegistry
* ğŸ“œ Form associated elements
* ğŸ“œ Lazy definition

.Shadow DOM
[slide=web-components]
_
//shadow DOM => isolation du CSS

image::img/drawings-optimized/web-component-slot.svg[]

image::img/drawings-optimized/web-component-events.svg[]

image::img/drawings-optimized/web-component-sd.svg[]

la suite de l'API standard entrÃ©e/sortie (custom prop, ::part)
systÃ¨me de slots :+1
transperce le shadow root avec des custom props
transperce le shadow root avec des ::part (et ::theme)

// [slide=todo]
// exemples de noeuds du DOM avec des ::part ou des custom prop

image::img/drawings/bookshelf-wc-sd.jpg[]

oÃ¹ Ã§a se place dans notre tableau de solutions ?
systÃ¨me de composants
isolation du CSS

.Shadow DOM
[slide=web-components, display=0]
* ğŸ˜¡ No SSR (without hacks)
* ğŸ“œ Declarative shadow DOM, custom elements
* ğŸ“œ Custom pseudo class
* ğŸ“œ CSS modules

.Shadow DOM
[slide=web-components, display=1]
* ğŸ˜¡ No SSR (without hacks)
* ğŸ“œ Declarative shadow DOM, custom elements
* ğŸ“œ Custom pseudo class
* ğŸ“œ CSS modules

.Shadow DOM
[slide=web-components, display=2]
* ğŸ˜¡ No SSR (without hacks)
* ğŸ“œ Declarative shadow DOM, custom elements
* ğŸ“œ Custom pseudo class
* ğŸ“œ CSS modules

.Shadow DOM
[slide=web-components, display=3]
* ğŸ˜¡ No SSR (without hacks)
* ğŸ“œ Declarative shadow DOM, custom elements
* ğŸ“œ Custom pseudo class
* ğŸ“œ CSS modules

.Shadow DOM
[slide=web-components, display=4]
* ğŸ˜¡ No SSR (without hacks)
* ğŸ“œ Declarative shadow DOM, custom elements
* ğŸ“œ Custom pseudo class
* ğŸ“œ CSS modules

.`<template>`
[slide=web-components]
_
// <template>, une maniÃ¨re "efficace" de cloner du DOM

.<template>
[source, language=html, subs="none"]
--
<template id="foobar">
  <div>Awesome!!</div>
</template>

const awesome = foobar.content.cloneNode(true);
parent.appendChild(awesome)
--

image::img/drawings/bookshelf-wc-tpl.jpg[]
//oÃ¹ Ã§a se place dans notre tableau de solutions ?
//pas vraiment Ã©quivalent Ã  la dÃ©finition de template qu'on a Ã©voquÃ© mais bon

.`<template>`
[slide=web-components, display=0]
* ğŸ˜¡ No interpolation or reactive "data-binding"
* ğŸ“œ Template instanciation (limited to simple values)
* ğŸ“œ HTML modules

.`<template>`
[slide=web-components, display=1]
* ğŸ˜¡ No interpolation or reactive "data-binding"
* ğŸ“œ Template instanciation (limited to simple values)
* ğŸ“œ HTML modules

.`<template>`
[slide=web-components, display=2]
* ğŸ˜¡ No interpolation or reactive "data-binding"
* ğŸ“œ Template instanciation (limited to simple values)
* ğŸ“œ HTML modules

.`<template>`
[slide=web-components, display=3]
* ğŸ˜¡ No interpolation or reactive "data-binding"
* ğŸ“œ Template instanciation (limited to simple values)
* ğŸ“œ HTML modules

image::img/screenshots/web-components-best-practices.jpg[url=https://developers.google.com/web/fundamentals/web-components/best-practices]

//comment surveiller la suite

image::img/screenshots/github-web-components.jpg[url=https://github.com/w3c/webcomponents]

image::img/screenshots/twitter-intenttoship.jpg[url=https://twitter.com/intenttoship]

image::img/screenshots/twitter-WebPlatformNews.jpg[url=https://twitter.com/WebPlatformNews]

// image::img/screenshots/github-tc39.jpg[url=https://github.com/tc39/proposals]

// des resources pour surveiller les specs et les implems dans les browsers
// TC39

//Est-ce que votre outil est prÃªt demain Ã  adopter un standard et jetter son implem pour vous faire profiter du support natif ?

[slide=blank]
Transition

Web Components will not "replace" your frameworks.
Their scope is not exactly the same, but current ecosystem will evolve and new one will rise.
Now that we deconstructed the different solutions frameworks and standards bring,
I think we have a better vision of the different layers that compose a Web project.
//I really encourage you to do this analysis on your projects and your very context.
It's pretty hard to do it well, but this vision should help us to write code that will age well,
and for this we need...

== A *SOLID* Web!

[.time]#00:30:00#
...good old software practices,
battle-tested patterns that will help us to separate concerns and limit coupling between layers.

[quote]
Code should be disposable,   it's far easier to do when   things are decoupled.

.Our context at *Clever Cloud*
[.logo]
image::img/cc-rocket-man.png[]
//image::img/clever-cloud-logo.svg[]

...chez Clever Cloud,
en espÃ©rant que Ã§a vous donne des idÃ©es pour votre contexte et votre stack.

[slide=blank, data-viewport=1]
_

DÃ©mo console
Ã§a c'est ce qu'on appelle notre console,
c'est le tableau de bord qui permet Ã  nos clients d'administrer leurs apps, leurs bdd, leurs addons...
montrer la console web en dÃ©mo
(Ã©cran overview)
citer logs, monitoring...
(switcher sur les vars d'env)

image::img/drawings/bookshelf-cc-before.jpg[]

Clever stack
...
7 years old
Component system (code separation but no clear API nor real runtime system)
Templating (lodash)
CSS (global) avec with a few rules like BEM
DOM (jquery + bacon)
No SSR
Home made router (merci quentin)
No real state manager (bacon)

.Our needs
[slide=web-components, display=0]
* ğŸ‘‹ Goodbye (Bacon.js + lodash templates)
* ğŸ’ª Components with an API and isolation
* â™»ï¸ Reusability (white label products)
* ğŸ¤¯ No feature less "big-bang" refactoring
* ğŸ”¢ Introduce new tools feature by feature

.Our needs
[slide=web-components, display=1]
* ğŸ‘‹ Goodbye (Bacon.js + lodash templates)
* ğŸ’ª Components with an API and isolation
* â™»ï¸ Reusability (white label products)
* ğŸ¤¯ No feature less "big-bang" refactoring
* ğŸ”¢ Introduce new tools feature by feature

.Our needs
[slide=web-components, display=2]
* ğŸ‘‹ Goodbye (Bacon.js + lodash templates)
* ğŸ’ª Components with an API and isolation
* â™»ï¸ Reusability (white label products)
* ğŸ¤¯ No feature less "big-bang" refactoring
* ğŸ”¢ Introduce new tools feature by feature

.Our needs
[slide=web-components, display=3]
* ğŸ‘‹ Goodbye (Bacon.js + lodash templates)
* ğŸ’ª Components with an API and isolation
* â™»ï¸ Reusability (white label products)
* ğŸ¤¯ No feature less "big-bang" refactoring
* ğŸ”¢ Introduce new tools feature by feature

.Our needs
[slide=web-components, display=4]
* ğŸ‘‹ Goodbye (Bacon.js + lodash templates)
* ğŸ’ª Components with an API and isolation
* â™»ï¸ Reusability (white label products)
* ğŸ¤¯ No feature less "big-bang" refactoring
* ğŸ”¢ Introduce new tools feature by feature

.Our needs
[slide=web-components, display=5]
* ğŸ‘‹ Goodbye (Bacon.js + lodash templates)
* ğŸ’ª Components with an API and isolation
* â™»ï¸ Reusability (white label products)
* ğŸ¤¯ No feature less "big-bang" refactoring
* ğŸ”¢ Introduce new tools feature by feature

sur certaines parties de l'app, on avait dÃ©jÃ  un modÃ¨le
comme les frameworks moderne avec un one way data flow
je modifie de la donnÃ©e, Ã§a par dans un stream bacon et Ã§a modifie le DOM
on a un peu atteint les limites de ce modÃ¨le bacon + lodash (perfs et modÃ¨le de pensÃ©e)
on a isolÃ© les "modules" dans des fichiers mais on a du CSS global et on a pas d'interface clairement dÃ©finie sur nos composants
on va avoir besoin que notre UI soit rÃ©utilisÃ©e en marque blanche ou marque grise
du coup, on doit pouvoir fournir certains parties de maniÃ¨re indÃ©pendantes un peu comme des lÃ©gos
// donnÃ©e qui vient d'appels REST et/ou de SSE
...
on va introduire des nouvelles technos feature aprÃ¨s feature
le fait que notre code n'Ã©tait pas enfermÃ© dans un framework nous facilite cette migration
*Code comments are for your colleagues but also for yourself in 6 months or a year.*
*Web Components are the same, they should be designed in a reusable way so third parties can reuse them but also so you can use them in a different stack tomorrow*

[slide=text]
Design phase:   from *top* to *bottom*

// [slide=todo]
// mock-up top => bottom des vars d'env

[slide=text]
Development phase:   from *bottom* to *top*

les enfants ne savent pas qui les utilisent
mais ils ont une idÃ©es de comment ils seront utilisÃ©s ou plutÃ´t de ce qu'ils doivent faire
les parents savent Ã  quoi servent leur enfants mais ne se soucis pas de comment Ã§a marche Ã  l'interieur
tu ne sais pas qu'il y a un router
tu ne sais pas qu'il y a un state manager
tu ne sais pas d'oÃ¹ vient la donnÃ©e

[slide=text]
*Storybook* **D**riven **D**evelopment

YOU NEED A DESIGN SYSTEM

//image::img/talk-storybook-ml-thuret.jpg[url=https://www.youtube.com/watch?v=a-fsVBaiv5A]
image::img/talk-storybook-ml-thuret.en.jpg[]

[slide=blank, data-viewport=2]
DÃ‰MO: le storybook de clever

DÃ‰MO: le storybook de clever
montrer les boutons avec leur interface
montrer le composant env-var-input
montrer le composant env-var-editor-simple
montrer le composant env-var-editor-expert
expliquer qu'ils ont la mÃªme signature et son donc trÃ¨s facilement interchangeable aux yeux du parent

image::img/drawings/bookshelf-cc-after.jpg[]

: web component pour la rÃ©utilisabilitÃ© et le cÃ´tÃ© agnostique du fwk et l'aspect standard
: lit-element + lit-html (petites libs)
: on en a testÃ© d'autres mais celles si nous convenait le mieux

image::img/screenshots/site-lit-html.jpg[url=https://lit-html.polymer-project.org/]

.lit-html
[source, language=javascript, subs="none"]
--
import { html, render } from 'lit-html';

let envVarInput = (envVar) => html`
    <span class="name">${envVar.name}</span>
    <input name=${envVar.name} .value=${envVar.value}>
`;

render(envVarInput({ name: 'FOO', value: 'BAR' }), someDomNode);
--

image::img/screenshots/site-lit-element.jpg[url=https://lit-element.polymer-project.org/]

.LitElement
[source, language=javascript, subs="none"]
--
import { LitElement, html } from 'lit-element';

class EnvVarInput extends LitElement {

  render() {
    return html`
      <!-- My template here -->
    `;
  }
}

customElements.define('env-var-input', EnvVarInput);
--

//[slide=text]
//SÃ©paration des *prÃ©occupations*   #â‰ #   SÃ©paration des *fichiers*
//SÃ©paration des *prÃ©occupations*   #!==#   SÃ©paration des *fichiers*
//SÃ©paration des *prÃ©occupations*  *!==* SÃ©paration des *fichiers*

// [quote]
// The more experienced a developer is, the less they are willing to be constraint by a framework. They tend to look for tools that help them and get out of the way.
// https://hueniverse.com/http-frameworks-must-die-717a37b6b164

image::img/drawings-optimized/layers-mixed-light.svg[]

image::img/drawings-optimized/layers-light.svg[]

layer data aware
layer auth aware
elements qui font des appels REST

// [slide=todo]
// remonter l'accÃ¨s Ã  la donnÃ©e le plus haut possible

.Reduce coupling with global stuffs
[slide=web-components]
* Router
* Data management (REST, WS, SSE...)
* State management
* Loading indicators
* Messages, notifs (info, error...)
* Modal box
* Keyboard shortcuts
//* document.title
// i18n

// i18n
// packaging
// Tests: do it like a  screen reader user wood do it
// Tests: no a great fan of snapshots

[slide=text]
Did we choose the *right tool*?

[.osef, slide=text]
*IDGASâ„¢ï¸*

[slide=text]
Not the *right* question!

[slide=text]
How much does it *cost*   to *change* our minds?

Did we choose the right tool, the right stack?
It's not important,
What is important is will we be able to changed our mind and what will be the cost?
To that question, I would answer yes.
The choices we made required some new knowledge about Web Components but I can only bet that this will be helpful in the future,
The abstraction librairies we chose are small and simple to learn.
Rewriting them would have almost no impact on the rest.

[slide=blank]
Transition

The last question is:

== Looking into  the *future*...

[.time]#00:40:00#
what about the future?

[slide=text]
*Beware* of those who   predict the future**!**

//See WC as the bytecode of the component isolation concept. It can be a compile to target
//People don't have to worry on the sugar

image::img/screenshots/article-frameworks-without-the-framework.jpg[url=https://svelte.technology/blog/frameworks-without-the-framework]

Vous pensez que 100k de JS, c'est pareil que 100k d'image => faux
Le JS est tÃ©lÃ©chargÃ©, parsÃ©, Ã©xÃ©cutÃ©, tout Ã§a, Ã§a prend du temps.

image::img/screenshots/article-compilers-are-the-new-frameworks.jpg[url=https://tomdale.net/2017/09/compilers-are-the-new-frameworks/]

//image::img/screenshots/tweet-future-web-assembly.jpg[url=https://twitter.com/getify/status/1111004737263075329]

//* le i18n (inlinÃ©)
//Discuter des webcomponent comme base pour l'authoring ou comme target de compilation

//[slide=todo-screenshot]
//Web Assembly

image::img/drawings/browser-12.jpg[]

image::img/drawings/browser-13.jpg[]

image::img/drawings/browser-14.jpg[]

framework runtime => compilers
schÃ©ma browser avec le code qui passe du runtime au build
bon ou mauvais ?
l'idÃ©al serait que l'input du compiler fonctionne sans build step et que l'output soit optimisÃ© aux petits oignons, comme ce qu'on fait quand on minifie
schÃ©ma browser avec le code qui passe du runtime et vers des implem du browser
...
Convaincre les gens que :
Le passÃ© se rÃ©pÃ¨te
Les outils vont et viennent
La constante, c'est le modÃ¨le des Ã©lÃ©ments du DOM (sorte de HDMI du Web)
Tout comme on a appris Ã  apprendre mais on garde certaines bases fondamentales, ils faut capitaliser sur les bases fondamentales (le web et ses standards) et adopter des facilitants par dessus avec une courbe d'apprentissage
// Ne pas hÃ©siter Ã  questionner les standards ou les frameworks Ã  la mode
// Qu'est-ce qui est important ? L'UX, la DX, les perfs ?
// On est trop dÃ©pendant de nos outils
// On est pas tjs assez exigent avec nos outils
// Il faut plus de compilation (html, css, js) et donc une Ã©tape intermÃ©diaire
// Ã‡a facilite le SSR, le HMR, plus rÃ©silient aux vieux browsers
// Compiler le i18n

[.stop-music.dark, slide=blank]
Fondu vers le noir

[.old.play-music]
== ...Epilogue

[.time]#00:42:00#

.So?
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-talks.svg[]

ğŸ‘©â€âš•ï¸ So? How was your group therapy?
ğŸ˜ I don't know, it didn't have time to go into each details so instead,
I tried to share the way I see things so people can adapt to their own context.

.Problem #1
[slide=problem]
Finding solutions   to problems we don't have (yet)

ğŸ˜ For problem number 1,
I tried to insist and move the focus back on needs:
1. Needs of the people using the products we build
2. Needs of the development team who works on the project
...
I mean nowadays, Web browsers have become those *complex application platform/runtime*.
Of course we need tools to reduce this complexity.
This idea is not to reinvent the wheel.
But, it's not a reason to say or think that we all have the same contexts and the same priorities.
...
I really hope people will get this reflex:
* "Oh look, new shiny tool!"
* "OK, what problem does it solve?"
* "Do I have this problem?"
and to rememeber :
* what you're developing
* with whom you're developing

.Problem #2
[slide=problem]
Getting locked into our own ecosystem

ğŸ˜ I also tried to deconstruct the different features/solutions that the current top 3 ecosytems bring.
The main idea is to keep a sharp point of view and to have an horizontal vision instead of a narrowed vertical vision.
In my opinion and my own experience, having a better understanding of those parts really helps me NOT TO fear change.
I know how I could replace something with a better/simpler implementation or something smaller using a new standard.
In the end, all those frameworks, librairies and standards are just tools.
We just need to take it easy and stay professional,
that means using them for the great features they bring
and stop worshiping them blindly.
ğŸ‘©â€âš•ï¸ Oh, and you talked about TV+VCR combos?

.Problem #3
[slide=problem]
Writing strongly coupled code   that does not age well with time

ğŸ˜ Yes, I tried to explain what we're currently trying to do at Clever Cloud to reduce coupling between our components, modules and the various layers.
I explained what our approach brings us in our own context.
We didn't invent anything, we're just trying to apply good old software patterns to the modern Web.
And those are just principles, there are always exceptions.
The idea is not to triple your design costs just to write "beautiful code" but just to invest the minimum of energy to reduce the impact of time.

.Thanks doctor!
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-love.svg[]

ğŸ˜ Je vous remercie docteur, Ã§a m'a bien aidÃ©
ğŸ˜ Thank you very much doctor, it really helped me,
and I also would like to thank every member of the group for listening to me to the end.

.thank  you !
[.reset-music, slide=poster]
Outro

Thank you very much.

//[slide=question]
//Questions ?
